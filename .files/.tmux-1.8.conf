# tmux 1.8
# ---
set -g default-terminal screen-256color
set -g base-index 1
setw -g pane-base-index 1
set -g history-limit 10000

# OSC 52
set -g set-clipboard on
set -as terminal-overrides ',screen*:Ms=\\E]52;%p1%s;%p2%s\\007'

# Automatically set window title
set-window-option -g automatic-rename on
set -g set-titles on

set -g status-keys vi
setw -g mode-keys vi
setw -g xterm-keys on

# No delay for escape key press
set -sg escape-time 0

set -g visual-bell off
set -g visual-activity off
setw -g monitor-activity on

# Enable mouse
setw -g mode-mouse on
set -g mouse-select-window on
set -g mouse-select-pane on
set -g mouse-resize-pane on
set -g mouse-utf on

# Keyboard mappings
# ---

# Change the prefix from 'C-b' to 'C-a'
unbind C-b
set -g prefix C-a
bind C-a send-prefix

bind v split-window -v
bind g split-window -h

# Vim style pane selection and resize
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

bind H resize-pane -L 5
bind J resize-pane -D 5
bind K resize-pane -U 5
bind L resize-pane -R 5

# Shift arrow to switch windows
bind -n S-Left  previous-window
bind -n S-Right next-window

# Session creation and navigation
bind N new-session
bind n switch-client -n
bind p switch-client -p

bind S setw synchronize-panes

# Open a man page in new vertical pane
bind / command-prompt -p 'Man>' "split-window -d -v 'exec man %%'"

# Help screen: rebind list-keys window into a new pane
bind ? split-window -h 'exec tmux list-keys | less'

# Quick view of processes
bind P split-window -h 'exec htop'

# Reload tmux config
bind r source-file ~/.tmux.conf \; display "Reloaded ~/.tmux.conf"

# Enter copy mode
bind Escape copy-mode

# vi-copy mode bindings
bind -t vi-copy 'v' begin-selection
bind -t vi-copy 'V' select-line
bind -t vi-copy 'C-v' rectangle-toggle
bind -t vi-copy 'y' copy-pipe '~/.config/tmux/plugins/yank.sh'
#bind -t vi-copy 'y' copy-selection
bind -t vi-copy Escape clear-selection
# bind -t vi-copy 'Y' send -X begin-selection \; send -X end-of-line \; send -X copy-selection

# Smart pane switching with awareness of vim splits
is_vim='echo "#{pane_current_command}" | grep -iqE "(^|\/)(g?(view|n?vim?)(diff)?|git)$"'
bind -n C-h if-shell "$is_vim" "send-keys C-h" "select-pane -L"
bind -n C-j if-shell "$is_vim" "send-keys C-j" "select-pane -D"
bind -n C-k if-shell "$is_vim" "send-keys C-k" "select-pane -U"
bind -n C-l if-shell "$is_vim" "send-keys C-l" "select-pane -R"
bind -n C-\ if-shell "$is_vim" "send-keys C-\\" "select-pane -l"

# Bring back clear screen under tmux prefix
bind C-l send-keys 'C-l'

# Search backwards
bind e copy-mode \; send-keys "?"

# Disable Ctrl+Arrows to maintain word jump
unbind -n C-Left
unbind -n C-Right
unbind -n C-Up
unbind -n C-Down

# Theme
# ---
set -g status-bg black
set -g status-fg colour243
set -g mode-bg colour67
set -g mode-fg colour235
set -g pane-border-fg colour240
set -g pane-active-border-fg colour6
set -g window-status-bg black
set -g window-status-current-bg colour239
set -g window-status-current-fg colour250
set -g window-status-current-attr bold
set -g window-status-activity-attr bold
setw -g window-status-activity-bg colour234
setw -g window-status-activity-fg brightblue
set -g status-interval 60
set -g status-left-length 30
set -g status-left '#{?client_prefix,#[bg=green]#[fg=black],#[fg=red]}(#S) #(whoami)'
set -g status-right '#[fg=yellow]#(cut -d " " -f 1-3 /proc/loadavg)#[default] #[fg=white]%H:%M#[default]'

#  vim: set ft=tmux ts=2 sw=2 tw=80 et :
